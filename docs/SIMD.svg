<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <rect width="1200" height="800" fill="white" stroke="gray" stroke-width="1"/>
  
  <text x="600" y="25" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">
    Full Demo: Parallel CUDA GPU + SIMD CPU Processing
  </text>
  
  <!-- Input section -->
  <rect x="50" y="50" width="1100" height="50" fill="#f5f5f5" stroke="black"/>
  <text x="600" y="70" text-anchor="middle" font-size="12" font-weight="bold">
    Input: 4 Market Types x 100K Returns Each
  </text>
  <text x="600" y="85" text-anchor="middle" font-size="10">
    Efficient Market, Mean Reverting (φ=-0.6), Trending (φ=0.6), Volatility Clustering
  </text>
  
  <!-- Split into two processing paths -->
  <rect x="50" y="120" width="550" height="600" fill="#e6f3ff" stroke="blue" stroke-width="2"/>
  <text x="325" y="140" text-anchor="middle" font-size="14" font-weight="bold">
    CUDA GPU Processing (Variance Ratios)
  </text>
  
  <rect x="620" y="120" width="530" height="600" fill="#fff0e6" stroke="orange" stroke-width="2"/>
  <text x="885" y="140" text-anchor="middle" font-size="14" font-weight="bold">
    SIMD CPU Processing (Autocorrelations)
  </text>
  
  <!-- CUDA side details -->
  <rect x="70" y="160" width="500" height="40" fill="#cce6ff" stroke="blue"/>
  <text x="320" y="175" text-anchor="middle" font-size="11">
    vr_calc = cuda_lib.create_vr_calculator()
  </text>
  <text x="320" y="190" text-anchor="middle" font-size="10">
    Initialize 4x RTX 3070 GPUs
  </text>
  
  <!-- 4 GPUs -->
  <rect x="80" y="210" width="100" height="400" fill="#b3daff" stroke="blue"/>
  <text x="130" y="230" text-anchor="middle" font-size="10" font-weight="bold">GPU 0</text>
  <text x="130" y="245" text-anchor="middle" font-size="8">h=[2,5]</text>
  
  <rect x="190" y="210" width="100" height="400" fill="#b3daff" stroke="blue"/>
  <text x="240" y="230" text-anchor="middle" font-size="10" font-weight="bold">GPU 1</text>
  <text x="240" y="245" text-anchor="middle" font-size="8">h=[10,20]</text>
  
  <rect x="300" y="210" width="100" height="400" fill="#b3daff" stroke="blue"/>
  <text x="350" y="230" text-anchor="middle" font-size="10" font-weight="bold">GPU 2</text>
  <text x="350" y="245" text-anchor="middle" font-size="8">h=[50,100]</text>
  
  <rect x="410" y="210" width="100" height="400" fill="#b3daff" stroke="blue"/>
  <text x="460" y="230" text-anchor="middle" font-size="10" font-weight="bold">GPU 3</text>
  <text x="460" y="245" text-anchor="middle" font-size="8">h=[200]</text>
  
  <!-- Market processing on GPUs -->
  <rect x="90" y="270" width="80" height="60" fill="white" stroke="blue"/>
  <text x="130" y="285" text-anchor="middle" font-size="8">Efficient Mkt</text>
  <text x="130" y="300" text-anchor="middle" font-size="7">5 kernels</text>
  <text x="130" y="315" text-anchor="middle" font-size="7">per horizon</text>
  <text x="130" y="325" text-anchor="middle" font-size="7">VR ≈ 1.0</text>
  
  <rect x="90" y="340" width="80" height="60" fill="white" stroke="blue"/>
  <text x="130" y="355" text-anchor="middle" font-size="8">Mean Rev</text>
  <text x="130" y="370" text-anchor="middle" font-size="7">φ=-0.6</text>
  <text x="130" y="385" text-anchor="middle" font-size="7">VR &lt; 1.0</text>
  <text x="130" y="395" text-anchor="middle" font-size="7">Mean reversion</text>
  
  <rect x="90" y="410" width="80" height="60" fill="white" stroke="blue"/>
  <text x="130" y="425" text-anchor="middle" font-size="8">Trending</text>
  <text x="130" y="440" text-anchor="middle" font-size="7">φ=0.6</text>
  <text x="130" y="455" text-anchor="middle" font-size="7">VR &gt; 1.0</text>
  <text x="130" y="465" text-anchor="middle" font-size="7">Momentum</text>
  
  <rect x="90" y="480" width="80" height="60" fill="white" stroke="blue"/>
  <text x="130" y="495" text-anchor="middle" font-size="8">Vol Cluster</text>
  <text x="130" y="510" text-anchor="middle" font-size="7">GARCH</text>
  <text x="130" y="525" text-anchor="middle" font-size="7">VR ≈ 1.0</text>
  <text x="130" y="535" text-anchor="middle" font-size="7">Heteroskedastic</text>
  
  <!-- GPU performance -->
  <rect x="80" y="620" width="480" height="60" fill="#4d94ff" stroke="blue"/>
  <text x="320" y="640" text-anchor="middle" font-size="11" fill="white" font-weight="bold">
    CUDA Performance
  </text>
  <text x="320" y="655" text-anchor="middle" font-size="9" fill="white">
    173K-280K points/ms aggregate across 4 GPUs
  </text>
  <text x="320" y="670" text-anchor="middle" font-size="9" fill="white">
    Output: VR arrays for dashboard left panel
  </text>
  
  <!-- SIMD side details -->
  <rect x="640" y="160" width="490" height="40" fill="#ffe6cc" stroke="orange"/>
  <text x="885" y="175" text-anchor="middle" font-size="11">
    acf_proc = simd_lib.create_autocorr_processor(8)
  </text>
  <text x="885" y="190" text-anchor="middle" font-size="10">
    8 OpenMP threads with AVX2 (4 doubles/op)
  </text>
  
  <!-- CPU threads and markets -->
  <rect x="650" y="220" width="470" height="80" fill="#ffcc99" stroke="orange"/>
  <text x="885" y="240" text-anchor="middle" font-size="11" font-weight="bold">
    CPU Thread Distribution (8 of 48 cores used)
  </text>
  <text x="670" y="260" font-size="9">Thread 0: Efficient Market ACF computation</text>
  <text x="670" y="275" font-size="9">Thread 1: Mean Reverting ACF computation</text>
  <text x="670" y="290" font-size="9">Thread 2: Trending ACF computation</text>
  <text x="670" y="280" font-size="9">Thread 3: Volatility Clustering ACF</text>
  
  <!-- AVX2 operations -->
  <rect x="650" y="320" width="220" height="120" fill="white" stroke="orange"/>
  <text x="760" y="340" text-anchor="middle" font-size="10" font-weight="bold">AVX2 Operations</text>
  <text x="670" y="360" font-size="8">__m256d data_vec = </text>
  <text x="670" y="375" font-size="7">  _mm256_loadu_pd(&data[i])</text>
  <text x="670" y="390" font-size="8">4 doubles loaded at once</text>
  <text x="670" y="410" font-size="8">__m256d result = </text>
  <text x="670" y="425" font-size="7">  _mm256_add_pd(vec1, vec2)</text>
  <text x="670" y="435" font-size="8">4 additions in 1 instruction</text>
  
  <!-- SIMD calculations -->
  <rect x="890" y="320" width="230" height="120" fill="white" stroke="orange"/>
  <text x="1005" y="340" text-anchor="middle" font-size="10" font-weight="bold">ACF Calculations</text>
  <text x="910" y="360" font-size="8">1. computeMeanAVX2()</text>
  <text x="920" y="375" font-size="7">Vectorized mean</text>
  <text x="910" y="390" font-size="8">2. computeVarianceAVX2()</text>
  <text x="920" y="405" font-size="7">Vectorized variance</text>
  <text x="910" y="420" font-size="8">3. For each lag k:</text>
  <text x="920" y="435" font-size="7">computeCovarianceSIMD(k)</text>
  
  <!-- SIMD results -->
  <rect x="650" y="460" width="470" height="100" fill="white" stroke="orange"/>
  <text x="885" y="480" text-anchor="middle" font-size="11" font-weight="bold">
    Autocorrelation Results per Market
  </text>
  <text x="670" y="500" font-size="9">Efficient Market: ACF ≈ 0 (no correlation)</text>
  <text x="670" y="515" font-size="9">Mean Reverting: ACF[1] &lt; 0 (negative correlation)</text>
  <text x="670" y="530" font-size="9">Trending: ACF[1] &gt; 0 (positive correlation)</text>
  <text x="670" y="545" font-size="9">Vol Clustering: ACF ≈ 0 but different pattern</text>
  
  <!-- SIMD performance -->
  <rect x="650" y="580" width="470" height="60" fill="#ff9933" stroke="orange"/>
  <text x="885" y="600" text-anchor="middle" font-size="11" fill="white" font-weight="bold">
    SIMD Performance
  </text>
  <text x="885" y="615" text-anchor="middle" font-size="9" fill="white">
    66K-234K points/ms using 8 threads + AVX2
  </text>
  <text x="885" y="630" text-anchor="middle" font-size="9" fill="white">
    Output: ACF arrays for dashboard right panel
  </text>
  
  <!-- Final combination -->
  <rect x="50" y="740" width="1100" height="40" fill="#333333"/>
  <text x="600" y="755" text-anchor="middle" font-size="12" fill="white" font-weight="bold">
    Dashboard Creation: GPU Variance Ratios + CPU Autocorrelations
  </text>
  <text x="300" y="770" text-anchor="middle" font-size="10" fill="white">
    Left Panel: VR(h) from CUDA
  </text>
  <text x="600" y="770" text-anchor="middle" font-size="10" fill="white">
    Synchronized results
  </text>
  <text x="900" y="770" text-anchor="middle" font-size="10" fill="white">
    Right Panel: ACF(k) from SIMD
  </text>
</svg>
